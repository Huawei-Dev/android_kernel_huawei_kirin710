

/*****************************************************************************
  1 ??????????
*****************************************************************************/
#include "oam_wdk.h"

#ifdef __cplusplus
#if __cplusplus
extern "C" {
#endif
#endif

#undef  THIS_FILE_ID
#define THIS_FILE_ID OAM_FILE_ID_HMAC_WAPI_SMS4_H
#ifdef _PRE_WLAN_FEATURE_WAPI
/*****************************************************************************/
/*****************************************************************************
  2 ??????
*****************************************************************************/
#define rotl(_x, _y) (((_x) << (_y)) | ((_x) >> (32 - (_y)))) /* ???????? */
#define getbyte(_x, _y) (((unsigned char *)&(_x))[_y]) /* ??y????????????x???????????? */

#define bytesub(_S, _A) ((_S)[((oal_uint32)(_A)) >> 24 & 0xFF] << 24 ^ \
                        (_S)[((oal_uint32)(_A)) >> 16 & 0xFF] << 16 ^ \
                        (_S)[((oal_uint32)(_A)) >>  8 & 0xFF] <<  8 ^ \
                        (_S)[((oal_uint32)(_A)) & 0xFF])

#define l1(_B) ((_B) ^ rotl(_B, 2) ^ rotl(_B, 10) ^ rotl(_B, 18) ^ rotl(_B, 24))

#define l2(_B) ((_B) ^ rotl(_B, 13) ^ rotl(_B, 23))

/*****************************************************************************
  3 ????????
*****************************************************************************/
/*****************************************************************************
  4 ????????????
*****************************************************************************/
/*****************************************************************************
  5 ??????????
*****************************************************************************/
/*****************************************************************************
  6 ????????
*****************************************************************************/
/*****************************************************************************
  7 STRUCT????
*****************************************************************************/
/*****************************************************************************
  8 UNION????
*****************************************************************************/
/*****************************************************************************
  9 OTHERS????
*****************************************************************************/
/*****************************************************************************
  10 ????????
*****************************************************************************/
extern oal_void hmac_sms4_crypt(oal_uint8 *puc_Input, oal_uint8 *puc_Output, oal_uint32 *pul_rk, oal_uint32 keyinlen);
extern oal_void hmac_sms4_keyext(oal_uint8 *puc_key, oal_uint32 *pul_rk, oal_uint32 keyinlen);

#endif
#ifdef __cplusplus
#if __cplusplus
}
#endif
#endif
